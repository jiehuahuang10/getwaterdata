<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>月度统计表工具 - 使用指南</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft YaHei", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }

        .card h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .card h3 {
            color: #764ba2;
            margin: 20px 0 10px 0;
            font-size: 1.3em;
        }

        .notice {
            background: #fff3cd;
            border-left: 5px solid #ffc107;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .notice.success {
            background: #d4edda;
            border-left-color: #28a745;
        }

        .notice.info {
            background: #d1ecf1;
            border-left-color: #17a2b8;
        }

        .notice.danger {
            background: #f8d7da;
            border-left-color: #dc3545;
        }

        .btn {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-size: 1.1em;
            margin: 10px 10px 10px 0;
            transition: transform 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .btn.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .btn.success {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .code-block {
            background: #2d2d2d;
            color: #f8f8f2;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
        }

        .steps {
            counter-reset: step-counter;
            list-style: none;
        }

        .steps li {
            counter-increment: step-counter;
            padding: 20px;
            margin: 15px 0;
            background: #f8f9fa;
            border-radius: 10px;
            position: relative;
            padding-left: 80px;
        }

        .steps li::before {
            content: counter(step-counter);
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .feature-card {
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.3s;
        }

        .feature-card:hover {
            transform: translateY(-5px);
        }

        .feature-card h4 {
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        table th, table td {
            padding: 12px;
            border: 1px solid #ddd;
            text-align: left;
        }

        table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        table tr:hover {
            background: #f5f5f5;
        }

        .formula {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-family: 'Courier New', monospace;
            border-left: 4px solid #2196F3;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .card {
                padding: 20px;
            }
            
            .steps li {
                padding-left: 20px;
                padding-top: 60px;
            }
            
            .steps li::before {
                left: 50%;
                transform: translateX(-50%);
                top: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- 头部 -->
        <div class="header">
            <h1>📊 月度统计表工具</h1>
            <p>石滩区分区计量数据管理系统</p>
            <div style="margin-top: 20px;">
                <a href="https://github.com/jiehuahuang10/getwaterdata" class="btn" target="_blank">📦 查看GitHub仓库</a>
                <a href="#download" class="btn secondary">💾 下载本地版</a>
                <a href="#usage" class="btn success">📖 使用教程</a>
            </div>
        </div>

        <!-- 重要提示 -->
        <div class="card">
            <h2>⚠️ 重要说明</h2>
            <div class="notice danger">
                <strong>注意：</strong>本页面为<strong>在线查看版本</strong>，只能查看使用说明和操作指导。<br>
                要实际操作Excel文件，请<strong>下载本地版</strong>在您的电脑上运行。
            </div>
            <div class="notice info">
                <strong>为什么需要本地版？</strong><br>
                • GitHub Pages只能托管静态网页，无法运行Python后端<br>
                • Excel文件操作需要Python的openpyxl库<br>
                • 数据源提取需要访问本地Excel文件<br>
                • 为了数据安全，所有Excel文件都在本地，不上传到GitHub
            </div>
        </div>

        <!-- 功能特性 -->
        <div class="card">
            <h2>✨ 功能特性</h2>
            <div class="feature-grid">
                <div class="feature-card">
                    <h4>🌐 Web界面</h4>
                    <p>浏览器访问，操作简单直观</p>
                </div>
                <div class="feature-card">
                    <h4>📊 自动计算</h4>
                    <p>输入售水量，自动计算损耗</p>
                </div>
                <div class="feature-card">
                    <h4>🔄 数据提取</h4>
                    <p>自动从数据源提取供水量</p>
                </div>
                <div class="feature-card">
                    <h4>✅ 数据验证</h4>
                    <p>智能检查数据完整性</p>
                </div>
                <div class="feature-card">
                    <h4>🎨 格式保持</h4>
                    <p>完全继承原表格样式</p>
                </div>
                <div class="feature-card">
                    <h4>🔒 数据安全</h4>
                    <p>所有数据只在本地</p>
                </div>
            </div>
        </div>

        <!-- 下载安装 -->
        <div class="card" id="download">
            <h2>💾 下载与安装</h2>
            
            <h3>方法1：克隆仓库（推荐）</h3>
            <div class="code-block">
git clone https://github.com/jiehuahuang10/getwaterdata.git
cd getwaterdata
pip install -r requirements.txt
            </div>

            <h3>方法2：下载ZIP</h3>
            <ol class="steps">
                <li>访问 <a href="https://github.com/jiehuahuang10/getwaterdata" target="_blank">GitHub仓库</a></li>
                <li>点击绿色的 "Code" 按钮</li>
                <li>选择 "Download ZIP"</li>
                <li>解压到您的电脑</li>
                <li>在命令行运行：<code>pip install -r requirements.txt</code></li>
            </ol>

            <div class="notice success">
                <strong>安装完成后：</strong><br>
                1. 将您的Excel文件放到 <code>excel_exports/</code> 文件夹<br>
                2. 运行命令：<code>python add_summary_web.py</code><br>
                3. 浏览器访问：<code>http://localhost:5001</code>
            </div>
        </div>

        <!-- 使用教程 -->
        <div class="card" id="usage">
            <h2>📖 使用教程</h2>
            
            <h3>第一步：准备数据文件</h3>
            <div class="notice info">
                确保以下文件在 <code>excel_exports/</code> 文件夹中：<br>
                • 石滩区分区计量.xlsx<br>
                • 石滩供水服务部每日总供水情况.xlsx
            </div>

            <h3>第二步：启动服务</h3>
            <div class="code-block">
# Windows
cd D:/pj/getwaterdata
python add_summary_web.py

# 看到以下信息表示启动成功：
# 访问地址: http://localhost:5001
            </div>

            <h3>第三步：打开Web界面</h3>
            <p>在浏览器中访问：<strong>http://localhost:5001</strong></p>

            <h3>第四步：输入售水量</h3>
            <ol class="steps">
                <li>查看当前Excel文件信息（自动显示）</li>
                <li>在输入框中填入三个区的售水量：
                    <ul style="margin-top: 10px;">
                        <li>1区售水量：例如 2050000</li>
                        <li>2区售水量：例如 500000</li>
                        <li>3区售水量：例如 290000</li>
                    </ul>
                </li>
                <li>点击"✅ 添加新月份统计表"按钮</li>
                <li>等待系统处理（自动提取数据、计算、写入Excel）</li>
                <li>看到成功提示，打开Excel文件查看结果</li>
            </ol>
        </div>

        <!-- 计算公式 -->
        <div class="card">
            <h2>🧮 计算公式说明</h2>
            
            <h3>供水量计算</h3>
            <div class="formula">
                <strong>1区供水量</strong> = 荔新大道 - 宁西2总表 - 如丰大道600监控表
            </div>
            <div class="formula">
                <strong>2区供水量</strong> = 如丰大道600监控表 + 新城大道医院NB - 三棵竹600监控表
            </div>
            <div class="formula">
                <strong>3区供水量</strong> = 三棵竹600监控表
            </div>

            <h3>损耗计算</h3>
            <div class="formula">
                <strong>损耗水量</strong> = 供水量 - 售水量
            </div>
            <div class="formula">
                <strong>水损耗率</strong> = 损耗水量 / 供水量 × 100%
            </div>

            <h3>数据来源</h3>
            <table>
                <thead>
                    <tr>
                        <th>监控点</th>
                        <th>数据源列名</th>
                        <th>统计周期</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>荔新大道</td>
                        <td>荔新大道</td>
                        <td rowspan="5">上月25日 至 本月24日</td>
                    </tr>
                    <tr>
                        <td>宁西2总表</td>
                        <td>宁西2总表</td>
                    </tr>
                    <tr>
                        <td>如丰大道</td>
                        <td>如丰大道600监控表</td>
                    </tr>
                    <tr>
                        <td>新城大道医院NB</td>
                        <td>新城大道医院NB</td>
                    </tr>
                    <tr>
                        <td>三棵竹</td>
                        <td>三棵竹600监控表</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- 数据验证 -->
        <div class="card">
            <h2>✅ 数据验证机制</h2>
            
            <h3>自动检查项</h3>
            <ol class="steps">
                <li><strong>重复检查</strong><br>系统会检查目标月份是否已存在，避免重复添加</li>
                <li><strong>数据完整性</strong><br>检查数据源文件中是否有目标月份24日的数据</li>
                <li><strong>输入验证</strong><br>售水量必须是非负整数，不能为空</li>
                <li><strong>文件存在性</strong><br>确认Excel文件和数据源文件都存在</li>
            </ol>

            <div class="notice">
                <strong>注意：</strong>如果系统提示"找不到完整数据"，说明数据源文件中还没有本月24日的数据，请等数据更新后再添加统计表。
            </div>
        </div>

        <!-- 常见问题 -->
        <div class="card">
            <h2>❓ 常见问题</h2>
            
            <h3>Q1: 为什么不能在GitHub Pages上直接操作？</h3>
            <p><strong>A:</strong> GitHub Pages只能托管静态网页（HTML/CSS/JavaScript），无法运行Python后端代码。Excel文件操作需要Python的openpyxl库，必须在本地运行。</p>

            <h3>Q2: 如何让团队其他成员使用？</h3>
            <p><strong>A:</strong> 有两个方案：</p>
            <ul>
                <li><strong>方案1（推荐）：</strong>在一台电脑上运行服务，其他人通过局域网访问（如：http://192.168.2.83:5001）</li>
                <li><strong>方案2：</strong>每个人从GitHub克隆代码，在自己电脑上运行，Excel文件通过共享文件夹同步</li>
            </ul>

            <h3>Q3: 会影响现有的GitHub Actions自动化吗？</h3>
            <p><strong>A:</strong> 完全不会！Web版在本地运行，GitHub Actions在云端运行，两者完全独立，互不影响。</p>

            <h3>Q4: Excel文件会上传到GitHub吗？</h3>
            <p><strong>A:</strong> 不会。.gitignore已配置排除所有Excel文件，保证数据安全。</p>

            <h3>Q5: 如何查看本机IP地址？</h3>
            <div class="code-block">
# Windows
ipconfig

# 查找 IPv4 地址，例如：192.168.2.83
# 其他人通过 http://你的IP:5001 访问
            </div>

            <h3>Q6: 端口5001被占用怎么办？</h3>
            <p><strong>A:</strong> 修改 <code>add_summary_web.py</code> 文件最后一行，将 <code>port=5001</code> 改为其他端口，如 <code>port=5002</code></p>
        </div>

        <!-- 技术架构 -->
        <div class="card">
            <h2>🏗️ 技术架构</h2>
            
            <h3>系统组成</h3>
            <table>
                <thead>
                    <tr>
                        <th>组件</th>
                        <th>技术</th>
                        <th>说明</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>后端服务</td>
                        <td>Flask</td>
                        <td>Web框架，处理请求</td>
                    </tr>
                    <tr>
                        <td>Excel操作</td>
                        <td>openpyxl</td>
                        <td>读写Excel文件</td>
                    </tr>
                    <tr>
                        <td>前端界面</td>
                        <td>HTML/CSS/JS</td>
                        <td>用户交互界面</td>
                    </tr>
                    <tr>
                        <td>数据提取</td>
                        <td>Python</td>
                        <td>从数据源提取统计</td>
                    </tr>
                </tbody>
            </table>

            <h3>文件结构</h3>
            <div class="code-block">
getwaterdata/
├── add_summary_web.py          # Flask服务器
├── templates/
│   └── add_summary.html        # Web界面
├── extract_water_data.py       # 数据提取
├── requirements.txt            # Python依赖
├── excel_exports/              # Excel文件（不上传）
│   ├── 石滩区分区计量.xlsx
│   └── 石滩供水服务部每日总供水情况.xlsx
└── docs/
    └── index.html              # GitHub Pages（本页面）
            </div>
        </div>

        <!-- 更新日志 -->
        <div class="card">
            <h2>📝 更新日志</h2>
            
            <h3>v1.0.0 (2025-10-22)</h3>
            <ul style="line-height: 2;">
                <li>✨ 初始发布</li>
                <li>✅ Web界面手动添加月度统计表</li>
                <li>✅ 支持输入售水量，自动计算损耗</li>
                <li>✅ 数据源自动提取（从数据源Excel）</li>
                <li>✅ 数据验证和完整性检查</li>
                <li>✅ 格式保持和样式继承</li>
                <li>✅ 完整的部署和使用文档</li>
            </ul>
        </div>

        <!-- 页脚 -->
        <div class="card" style="text-align: center; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
            <h2 style="color: white; border-bottom-color: white;">🎉 准备好了吗？</h2>
            <p style="font-size: 1.2em; margin: 20px 0;">下载本地版，开始使用强大的月度统计表工具！</p>
            <a href="https://github.com/jiehuahuang10/getwaterdata" class="btn" style="background: white; color: #667eea;" target="_blank">
                🚀 前往GitHub下载
            </a>
        </div>

        <div style="text-align: center; color: white; margin-top: 20px; padding: 20px;">
            <p>© 2025 石滩区分区计量数据管理系统 | <a href="https://github.com/jiehuahuang10/getwaterdata" style="color: white;" target="_blank">GitHub</a></p>
        </div>
    </div>
</body>
</html>

